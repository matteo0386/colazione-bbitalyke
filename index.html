<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<title>BB Italyke – Colazione</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Carica script per inviare ordini -->
<script src="https://matteo0386.github.io/bbitalyke-orders/submitOrder.js"></script>
<script src="https://matteo0386.github.io/bbitalyke-orders/config.js"></script>

<style>
:root {
 --primary:#0A84FF; --secondary:#5AC8FA; --accent:#FFD60A;
 --bg:#f4f7fb; --card:#ffffff; --text:#222;
 --radius:18px; --shadow:0 6px 18px rgba(0,0,0,.1);
}
@media(prefers-color-scheme:dark){
 :root{--bg:#050816;--card:#111827;--text:#f9fafb;--shadow:0 8px 24px rgba(0,0,0,.45);}
}
body{
 background:var(--bg);margin:0;padding:0;
 font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,Arial;
 color:var(--text);
}
.container{max-width:430px;margin:auto;padding:20px;}
h1{text-align:center;font-size:30px;margin-bottom:5px;color:var(--primary);font-weight:800;}
.subtitle{text-align:center;font-size:15px;margin-bottom:22px;color:#666;}
.card{
 background:var(--card);padding:18px;margin-bottom:18px;
 border-radius:var(--radius);box-shadow:var(--shadow);
 opacity:0;transform:translateY(20px);animation:fadeIn .6s forwards;
}
@keyframes fadeIn{to{opacity:1;transform:translateY(0);}}
h2{margin:0 0 10px;font-size:20px;color:var(--primary);font-weight:700;}
.row{
 display:flex;justify-content:space-between;align-items:center;
 padding:8px 0;border-bottom:1px solid #e5e7eb;
}
.row:last-child{border-bottom:none;}
.label{width:60%;font-size:16px;}
.qty-box{display:flex;align-items:center;gap:6px;}
button.pm{
 width:32px;height:32px;border-radius:50%;border:none;
 background:linear-gradient(135deg,var(--secondary),var(--primary));
 color:white;font-size:18px;font-weight:700;cursor:pointer;
}
input.qty{
 width:48px;padding:6px;font-size:16px;border-radius:8px;
 border:2px solid var(--secondary);text-align:center;
}
input[type=text],select{
 width:100%;max-width:280px;padding:10px;font-size:16px;
 border-radius:12px;border:2px solid var--)secondary);background:white;
}
#invio{
 width:100%;background:linear-gradient(135deg,#22c55e,#16a34a);
 color:white;padding:16px;border:none;border-radius:999px;
 font-size:20px;font-weight:800;cursor:pointer;margin-top:20px;
}
#okMsg{
 display:none;text-align:center;font-size:20px;font-weight:700;
 color:#22c55e;margin-top:20px;
}
</style>
</head>

<body>
<div class="container">
<h1>BB Italyke – Colazione</h1>
<p class="subtitle">Seleziona ciò che desideri</p>

<div class="card">
<h2>Ospite</h2>

<label>Nome</label>
<input type="text" id="nome">

<label>Camera</label>
<select id="camera">
<option value="">Seleziona</option>
<option value="Euterpe">Euterpe</option>
<option value="Talia">Talia</option>
<option value="Tersicore">Tersicore</option>
<option value="Erato">Erato</option>
</select>

<label>Orario</label>
<select id="orario">
<option value="">Seleziona</option>
<option value="08:00">08:00</option>
<option value="09:00">09:00</option>
</select>
</div>
<!-- CATEGORIE DEL MENU -->
<script>
function categoria(titolo, items){
  let html = `<div class='card'><h2>${titolo}</h2>`;
  items.forEach(([label, id])=>{
    html += `
      <div class='row'>
        <span class='label'>${label}</span>
        <div class='qty-box'>
          <button type='button' class='pm' onclick="dec('${id}')">−</button>
          <input type='number' class='qty' id='${id}' value='0' min='0'>
          <button type='button' class='pm' onclick="inc('${id}')">+</button>
        </div>
      </div>`;
  });
  html += `</div>`;
  return html;
}
</script>

<div id="menuArea"></div>

<script>
// DEFINIZIONE CATEGORIE
const sezioni = {
"Bevande Calde":[
["Caffè espresso","qtyCaffeEspresso"],
["Caffè Americano","qtyCaffeAmericano"],
["Tè","qtyThe"],
["Cioccolata calda","qtyCioccolataCalda"],
["Cappuccino","qtyCappuccino"],
["Cappuccino Soia","qtyCappuccinoSoia"],
["Cappuccino No Lattosio","qtyCappuccinoNoLattosio"],
["Latte caldo","qtyLatteCaldo"],
["Latte di Soia","qtyLatteSoiaCaldo"],
["Latte No Lattosio","qtyLatteNoLattosioCaldo"]
],
"Bevande Fredde":[
["Latte","qtyLatteFreddo"],
["Latte di Soia","qtyLatteSoiaFreddo"],
["Latte No Lattosio","qtyLatteNoLattosioFreddo"],
["Succo arancia","qtySuccoArancio"],
["Succo ananas","qtySuccoAnanas"],
["Succo frutti rossi","qtySuccoFruttiRossi"]
],
"Yogurt":[
["Yogurt bianco","qtyYogurtBianco"],
["Yogurt ai frutti","qtyYogurtFrutti"]
],
"Dolci":[
["Cornetto","qtyCornetto"],
["Dolce artigianale","qtyDolceArtigianale"],
["Fette biscottate","qtyFetteBiscottate"],
["Burro","qtyBurro"],
["Marmellata","qtyMarmellata"],
["Nutella","qtyNutella"],
["Cereali","qtyCereali"]
],
"Salati":[
["Uova bollite","qtyUovaBollite"],
["Uova strapazzate","qtyUovaStrapazzate"],
["Salumi","qtySalumi"],
["Formaggio","qtyFormaggio"],
["Pane","qtyPane"],
["Focaccia","qtyFocaccia"]
],
"Frutta":[
["Frutta fresca","qtyFruttaFresca"]
],
"Richieste Speciali":[
["Spremuta d’arancia (6€)","qtySpremuta"],
["Toast prosciutto e formaggio (6€)","qtyToast"],
["Pancake (6€)","qtyPancake"],
["Yogurt greco (4€)","qtyYogurtGreco"],
["Yogurt proteico (5€)","qtyYogurtProteico"],
["Porridge (7€)","qtyPorridge"],
["Take Away (25€)","qtyTakeAway"]
]
};

// RENDER CATEGORIE
document.getElementById("menuArea").innerHTML =
  Object.entries(sezioni)
    .map(([titolo, items]) => categoria(titolo, items))
    .join("");

// FUNZIONI + / -
function inc(id){
 let el=document.getElementById(id);
 el.value=parseInt(el.value||0)+1;
}
function dec(id){
 let el=document.getElementById(id);
 let v=parseInt(el.value||0);
 if(v>0) el.value=v-1;
}

// RACCOLTA PRODOTTI
function getProdotti(){
  let prodotti = {};
  Object.values(sezioni).flat().forEach(([label,id])=>{
    let q = parseInt(document.getElementById(id).value||0);
    if(q>0){
      prodotti[label] = q;
    }
  });
  return prodotti;
}

// INVIO ORDINE AL SISTEMA
async function inviaOrdine(){
  const nome = document.getElementById("nome").value.trim();
  const camera = document.getElementById("camera").value;
  const orario = document.getElementById("orario").value;

  if(!nome || !camera || !orario){
    alert("Compila tutti i campi: nome, camera e orario.");
    return;
  }

  const prodotti = getProdotti();

  if(Object.keys(prodotti).length === 0){
    alert("Seleziona almeno un prodotto.");
    return;
  }

  // COSTRUISCO L’OGGETTO ORDINE
  const oggi = new Date().toISOString().slice(0,10);
  const ordine = {
    data: oggi,
    nome,
    camera,
    orario,
    prodotti,
    timestamp: new Date().toISOString()
  };

  const ok = await submitOrder(ordine);

  if(ok){
    document.getElementById("okMsg").style.display="block";
    window.scrollTo(0,0);
  } else {
    alert("Errore nell'invio dell'ordine. Riprova.");
  }
}
</script>

<button id="invio" onclick="inviaOrdine()">INVIA ORDINE</button>

<div id="okMsg">
  ✔️ Ordine inviato con successo!
</div>

</div> <!-- container -->
</body>
</html>

